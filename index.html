<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Valentine  üíò</title>

<style>
body {
  margin: 0;
  height: 100vh;
  background: linear-gradient(135deg, #ffb3c6, #ffd6e0);
  display: flex;
  justify-content: center;
  align-items: center;
  font-family: "Georgia", serif;
}

.card-box {
  background: white;
  padding: 30px;
  border-radius: 25px;
  width: 380px;
  text-align: center;
  box-shadow: 0 25px 50px rgba(0,0,0,0.25);
}

h2 {
  color: #c9184a;
}

button {
  margin-top: 20px;
  padding: 12px 30px;
  border-radius: 30px;
  border: none;
  background: #ff4d6d;
  color: white;
  font-size: 16px;
  cursor: pointer;
}

button:hover {
  background: #c9184a;
}

input[type="text"] {
  margin-top: 10px;
  padding: 8px;
  border-radius: 10px;
  border: 1px solid #ff4d6d;
  text-align: center;
}

.hidden {
  display: none;
}

canvas {
  margin-top: 15px;
  border-radius: 15px;
}
</style>
</head>

<body>

<div class="card-box">

  <!-- STEP 1 -->
  <div id="step1">
    <h2>Do you wanna be Ayushi‚Äôs Valentine? üíò</h2>
    <button onclick="start()">YES</button>
  </div>

  <!-- STEP 2 -->
  <div id="step2" class="hidden">
    <h2 id="loadingText">Checking with Cupid‚Ä¶</h2>
  </div>

  <!-- STEP 3 -->
  <div id="step3" class="hidden">
    <h2>Congratulations lovebirds! üíñ</h2>

    <canvas id="canvas" width="340" height="300"></canvas>

    <input type="text" id="nameInput" placeholder="Enter your name üíï" oninput="drawCardBase()">
    <br>
    <input type="file" accept="image/*" onchange="loadUser(event)">
    <br>
    <button onclick="download()">Download card ‚ù§Ô∏è</button>
  </div>

</div>

<script>
const canvas = document.getElementById("canvas");
const ctx = canvas.getContext("2d");

let userImg = null;

// Ayushi image
const ayushiImg = new Image();
ayushiImg.src = "valentine.jpeg";

// Circle crop
function circle(img, x, y, r) {
  ctx.save();
  ctx.beginPath();
  ctx.arc(x, y, r, 0, Math.PI * 2);
  ctx.clip();
  ctx.drawImage(img, x - r, y - r, r * 2, r * 2);
  ctx.restore();
}

// Draw card
function drawCardBase() {
  ctx.clearRect(0, 0, canvas.width, canvas.height);

  ctx.fillStyle = "#fff0f3";
  ctx.fillRect(0, 0, canvas.width, canvas.height);

  ctx.strokeStyle = "#ff4d6d";
  ctx.lineWidth = 4;
  ctx.strokeRect(6, 6, canvas.width - 12, canvas.height - 12);

  // Header text
  ctx.textAlign = "center";
  ctx.fillStyle = "#c9184a";
  ctx.font = "22px Georgia";
  ctx.fillText("Happy Valentine‚Äôs Day! üíï", canvas.width / 2, 38);

  ctx.font = "14px Georgia";
  ctx.fillStyle = "#6a040f";
  ctx.fillText("Some connections are written in the stars ‚ú®", canvas.width / 2, 60);
  ctx.fillText("‚Ä¶and some just feel right üíñ", canvas.width / 2, 78);

  // Images
  circle(ayushiImg, 95, 155, 45);

  ctx.font = "42px serif";
  ctx.fillText("‚ù§Ô∏è", canvas.width / 2, 170);

  if (userImg) {
    circle(userImg, 245, 155, 45);
  }

  // Single-line signature
  const name = document.getElementById("nameInput").value || "You";
  ctx.font = "16px Georgia";
  ctx.fillStyle = "#c9184a";
  ctx.fillText(`From Ayushi & ${name} xoxo üíå`, canvas.width / 2, 235);
}

// Flow
function start() {
  step1.classList.add("hidden");
  step2.classList.remove("hidden");

  const texts = ["Checking with Cupid‚Ä¶", "Processing feelings‚Ä¶", "Almost there‚Ä¶"];
  let i = 0;

  const interval = setInterval(() => {
    loadingText.innerText = texts[i++];
    if (i === texts.length) {
      clearInterval(interval);
      setTimeout(showCard, 700);
    }
  }, 700);
}

function showCard() {
  step2.classList.add("hidden");
  step3.classList.remove("hidden");

  ayushiImg.complete ? drawCardBase() : ayushiImg.onload = drawCardBase;
}

// Upload user image
function loadUser(e) {
  userImg = new Image();
  userImg.onload = drawCardBase;
  userImg.src = URL.createObjectURL(e.target.files[0]);
}

// Download
function download() {
  const link = document.createElement("a");
  link.download = "congratulations-lovebirds.png";
  link.href = canvas.toDataURL("image/png");
  link.click();
}
</script>

</body>
</html>
