<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Valentine üíò</title>

<style>
* {
  box-sizing: border-box;
}

body {
  margin: 0;
  min-height: 100vh;
  background: linear-gradient(135deg, #ffb3c6, #ffd6e0);
  display: flex;
  justify-content: center;
  align-items: center;
  font-family: Georgia, serif;
  padding: 15px;
}

.card-box {
  background: white;
  padding: 22px;
  border-radius: 25px;
  width: 100%;
  max-width: 400px;
  text-align: center;
  box-shadow: 0 25px 50px rgba(0,0,0,0.25);
}

h2 {
  color: #c9184a;
  font-size: 1.4rem;
}

button {
  margin-top: 20px;
  padding: 14px 28px;
  border-radius: 30px;
  border: none;
  background: #ff4d6d;
  color: white;
  font-size: 16px;
  cursor: pointer;
  width: 100%;
}

button:hover {
  background: #c9184a;
}

input[type="file"],
input[type="text"] {
  width: 100%;
  margin-top: 12px;
  padding: 10px;
  border-radius: 12px;
  border: 1px solid #ccc;
  font-size: 14px;
}

.hidden {
  display: none;
}

canvas {
  margin-top: 15px;
  width: 100%;
  height: auto;
  border-radius: 15px;
}
</style>
</head>

<body>

<div class="card-box">

  <!-- STEP 1 -->
  <div id="step1">
    <h2>Do you wanna be Ayushi‚Äôs Valentine? üíò</h2>
    <button onclick="start()">YES üíñ</button>
  </div>

  <!-- STEP 2 -->
  <div id="step2" class="hidden">
    <h2 id="loadingText">Checking with Cupid‚Ä¶</h2>
  </div>

  <!-- STEP 3 -->
  <div id="step3" class="hidden">
    <h2>Congratulations lovebirds! üíñ</h2>

    <canvas id="canvas"></canvas>

    <input type="text" id="nameInput" placeholder="Enter your name üíå">
    <input type="file" accept="image/*" onchange="loadUser(event)">
    <button onclick="download()">Download card ‚ù§Ô∏è</button>
  </div>

</div>

<script>
const canvas = document.getElementById("canvas");
const ctx = canvas.getContext("2d");

// Responsive canvas size
function resizeCanvas() {
  const width = Math.min(340, window.innerWidth - 80);
  canvas.width = width;
  canvas.height = width * 0.65;
}
resizeCanvas();
window.addEventListener("resize", resizeCanvas);

// Load Ayushi image
const ayushiImg = new Image();
ayushiImg.src = "valentine.jpeg";

// Helper: circular crop
function circle(img, x, y, r) {
  ctx.save();
  ctx.beginPath();
  ctx.arc(x, y, r, 0, Math.PI * 2);
  ctx.clip();
  ctx.drawImage(img, x - r, y - r, r * 2, r * 2);
  ctx.restore();
}

// Draw base card
function drawCardBase() {
  ctx.clearRect(0, 0, canvas.width, canvas.height);

  // Background
  ctx.fillStyle = "#fff0f3";
  ctx.fillRect(0, 0, canvas.width, canvas.height);

  // Border
  ctx.strokeStyle = "#ff4d6d";
  ctx.lineWidth = 4;
  ctx.strokeRect(6, 6, canvas.width - 12, canvas.height - 12);

  const centerY = canvas.height / 2;

  // Ayushi image
  circle(ayushiImg, canvas.width * 0.28, centerY, canvas.width * 0.13);

  // Heart
  ctx.font = `${canvas.width * 0.12}px serif`;
  ctx.textAlign = "center";
  ctx.fillText("‚ù§Ô∏è", canvas.width / 2, centerY + 15);

  // Footer text
  const name = document.getElementById("nameInput").value || "You";
  ctx.font = `${canvas.width * 0.05}px Georgia`;
  ctx.fillStyle = "#c9184a";
  ctx.fillText(`From Ayushi & ${name} xoxo üíå`, canvas.width / 2, canvas.height - 20);
}

// FLOW
function start() {
  step1.classList.add("hidden");
  step2.classList.remove("hidden");

  const texts = [
    "Checking with Cupid‚Ä¶",
    "Processing feelings‚Ä¶",
    "Almost there‚Ä¶"
  ];

  let i = 0;
  const interval = setInterval(() => {
    loadingText.innerText = texts[i++];
    if (i === texts.length) {
      clearInterval(interval);
      setTimeout(showCard, 800);
    }
  }, 700);
}

function showCard() {
  step2.classList.add("hidden");
  step3.classList.remove("hidden");

  ayushiImg.onload = drawCardBase;
  drawCardBase();
}

// User image
function loadUser(e) {
  const img = new Image();
  img.onload = () => {
    drawCardBase();
    circle(img, canvas.width * 0.72, canvas.height / 2, canvas.width * 0.13);
  };
  img.src = URL.createObjectURL(e.target.files[0]);
}

// Download
function download() {
  const link = document.createElement("a");
  link.download = "congratulations-lovebirds.png";
  link.href = canvas.toDataURL("image/png");
  link.click();
}
</script>

</body>
</html>
